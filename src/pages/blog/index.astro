---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "../../components/Footer.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import Header from "../../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main class="w-[960px] max-w-full mx-auto px-4">
      <section>
        <ul class="flex flex-wrap gap-8 max-md:gap-2 list-none m-0 p-0">
          {
            posts.map((post, index) => (
              <li
                class:list={[
                  "w-[calc(50%-1rem)] max-md:w-full max-md:text-center",
                  {
                    "w-full mb-4 max-md:mb-0 text-center first-post": index === 0,
                  },
                ]}
              >
                <a
                  href={`/blog/${post.id}/`}
                  class="block no-underline transition-all duration-200 group"
                >
                  {post.data.heroImage && (
                    <div
                      class:list={[
                        "mb-2 img-container",
                        { "w-full": index === 0 },
                      ]}
                    >
                      <Image
                        width={720}
                        height={360}
                        src={post.data.heroImage}
                        alt=""
                        class="img-zoom group-hover:scale-105"
                        transition:name={`hero-${post.id}`}
                      />
                    </div>
                  )}
                  <h4
                    class:list={[
                      "m-0 leading-none transition-colors",
                      index === 0
                        ? "text-4xl max-md:text-2xl text-blue-600 group-hover:text-blue-700 dark:text-blue-400 dark:group-hover:text-blue-300"
                        : "text-xl text-slate-900 group-hover:text-blue-600 dark:text-slate-100 dark:group-hover:text-blue-400",
                    ]}
                  >
                    {post.data.title}
                  </h4>
                  <p class="m-0 text-muted text-hover-primary group-hover:text-blue-600">
                    <FormattedDate date={post.data.pubDate} />
                  </p>
                </a>
              </li>
            ))
          }
        </ul>
      </section>
    </main>
    <Footer />
  </body>
</html>
